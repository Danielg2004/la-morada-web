<div class="container ebooks-list">
  <!-- Toolbar -->
  <div class="toolbar">
    <input
      class="search"
      [(ngModel)]="q"
      type="text"
      placeholder="Buscar e-books por título o descripción" />
    <button class="btn" (click)="search()">Buscar</button>
    <button class="btn outline" (click)="toggleFavorites()">
      {{ showOnlyFavorites ? 'Todos' : 'Solo favoritos' }}
    </button>
    <a class="btn outline" routerLink="/ebooks/admin" *ngIf="canCreate()">Subir e-book</a>
    <a class="btn outline" routerLink="/carrito">Ver carrito</a>
  </div>

  <!-- Grid -->
  <div class="grid-cards">
    <div class="card book" *ngFor="let e of ebooks">
      <div class="cover-wrap">
        <img class="cover" [src]="e.imagen_url || 'assets/placeholder-book.png'" alt="Portada" />
      </div>

      <a class="title" [routerLink]="['/ebooks', e.id]">{{ e.titulo }}</a>
      <p class="desc">{{ e.descripcion || 'Sin descripción' }}</p>

      <div class="price-row">
        <span class="price" *ngIf="(e.price || 0) > 0; else gratisTpl">
          {{ e.price | currency:'USD':'symbol':'1.2-2' }}
        </span>
        <ng-template #gratisTpl><span class="gratis">Gratis</span></ng-template>

        <div class="actions">
          <button class="btn xs" (click)="addToCart(e)">Agregar al carrito</button>
          <button class="btn xs outline" (click)="toggleFav(e)">
            {{ e.es_favorito ? 'Quitar favorito' : 'Favorito' }}
          </button>
          <a class="btn xs outline" [routerLink]="['/ebooks', e.id]">Ver detalle</a>
        </div>
      </div>
    </div>
  </div>
</div>
